import numpy as np
import pandas as pd
import os
import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter1d
from matplotlib import rcParams

config = {
    "font.family":'Times New Roman',  # 设置字体类型
    "axes.unicode_minus": False, #解决负号无法显示的问题
    'font.size': 14
}
rcParams.update(config)

y1=[1.82484114,1.61934698,1.42325354,1.18645692,0.99679542,0.81235814
,0.69221246,0.57350391,0.53522062,0.46724868,0.38443002,0.34952313
,0.29393184,0.27387938,0.25006568,0.23199385,0.23777777,0.20342299
,0.19737878,0.19733766,0.19015457,0.17631452,0.17032024,0.16509557
,0.17675574,0.15509242,0.14433168,0.16872898,0.12139396,0.15436745
,0.1410764,0.10994781,0.13972928,0.11517416,0.13962688,0.11843766
,0.12686846,0.12910345,0.12301002,0.12173673,0.09950085,0.12561303
,0.1211513,0.08440237,0.08976425,0.09892494,0.1184626,0.10658394
,0.09756867,0.09677247,0.09331801,0.09810522,0.10762879,0.10714051
,0.09252614,0.1028876,0.09034766,0.08360821,0.11198355,0.08593063
,0.10722812,0.0996592,0.08161698,0.06278672,0.08463571,0.08977352
,0.08147532,0.07254912,0.10964235,0.08790901,0.10893492,0.08068547
,0.07870141,0.07108662,0.08680122,0.09041806,0.07106076,0.0649687
,0.08038697,0.06760686,0.07887342,0.06856199,0.05479429,0.07562268
,0.05955558,0.07594617,0.08775342,0.06049807,0.06802571,0.08459888
,0.07881876,0.07240555,0.05454021,0.06661732,0.06782792,0.06186704
,0.08104745,0.06498183,0.07948795,0.06040981,0.06503981,0.07123736
,0.08340642,0.06268533,0.07141805,0.07105149,0.06376979,0.08477722
,0.06655858,0.06706236,0.07209204,0.05647584,0.07507382,0.07890619
,0.06161693,0.0589616,0.05756332,0.07907745,0.07500764,0.06034864
,0.05798305,0.05722208,0.07166971,0.07019596,0.05298281,0.06141643
,0.08436114,0.06680391,0.06007258,0.07171108,0.05670757,0.05973572
,0.0537939,0.06986094,0.07064765,0.07716462,0.05412301,0.06363127
,0.054195,0.07345705,0.07114553,0.06407096,0.06498316,0.05622411
,0.06178972,0.06038381,0.06105915,0.05464687,0.06053899,0.06174816
,0.05126629,0.05683771,0.04941503,0.05998896,0.06380524,0.05894349
,0.06249575,0.06788305,0.06590714,0.05995404,0.05881704,0.05893451
,0.07065377,0.06606839,0.05963126,0.0594671,0.05447062,0.07483203
,0.05380388,0.06181571,0.05987323,0.04855241,0.0606955,0.07351378
,0.08512773,0.05714508,0.06091617,0.06345982,0.08115377,0.04315103
,0.07545887,0.06306924,0.05218277,0.06924435,0.06200208,0.06384856
,0.03270269,0.04588591,0.0634519,0.05216377,0.06588339,0.05126243
,0.05151697,0.07672483,0.06586844,0.06074813,0.06179126,0.05933967
,0.05017489,0.06034685,0.0589179,0.05335547,0.0486986,0.05457981
,0.05537626,0.06133864,0.0573161,0.05159052,0.05487625,0.07401112
,0.0628214,0.05528794,0.07338318,0.06779797,0.05758843,0.05194063
,0.03802762,0.06558191,0.05526876,0.06131939,0.07889634,0.06013139
,0.05853057,0.0534564,0.04897764,0.06961648,0.06458661,0.05661879
,0.06102006,0.04594446,0.04925725,0.05539533,0.05019588,0.06219371
,0.04468617,0.04679823,0.03452411,0.05747429,0.05150471,0.06050563
,0.05183597,0.04184199,0.05401618,0.05151052,0.04467665,0.05963003
,0.04979847,0.06210661,0.04487133,0.04882286,0.04459681,0.06095978
,0.04431246,0.03914808,0.04393673,0.06393928,0.06911945,0.05172149
,0.07204875,0.04836508,0.0487287,0.05263284,0.05088506,0.04267461
,0.05881233,0.04451686,0.04827517,0.04660314,0.0430558,0.05135621
,0.04713907,0.06917752,0.0420155,0.06039691,0.05565973,0.05203616
,0.05129879,0.05091624,0.05033302,0.06105749,0.06467131,0.04871828
,0.04255822,0.05392148,0.0575004,0.04462541,0.05558956,0.07624687
,0.04684109,0.0534031,0.05636701,0.04786408,0.06529876,0.05936115
,0.05979657,0.04675398,0.05110087,0.04808007,0.03777989,0.04648638
,0.04054054,0.05098922,0.05485126,0.06491771,0.05019775,0.05484366
,0.06175157,0.04386578,0.06569295,0.06115834,0.0631054,0.04529981
,0.05022491,0.04310276,0.03661683,0.03481312,0.05349524,0.05850141
,0.06555559,0.04471528,0.05014455,0.05170647,0.04625098,0.04732468
,0.04176349,0.04417735,0.05829337,0.07423657,0.04432965,0.03976355
,0.05033833,0.05311463,0.04752877,0.03975618,0.04916817,0.08043625
,0.04841567,0.04531097,0.05178992,0.03961756,0.04136216,0.05740393
,0.04495823,0.04109804,0.05134135,0.05197246,0.04522015,0.04807876
,0.04702363,0.05365576,0.04318621,0.04772004,0.05446206,0.04893045
,0.06264172,0.05314413,0.0536718,0.03324981,0.05820552,0.05688235
,0.04840865,0.05634174,0.05298531,0.04449488,0.07926987,0.0418818
,0.05418719,0.05159722,0.0490929,0.05347639,0.0531128,0.05835012
,0.06622997,0.04884277,0.05052298,0.04932867,0.039377,0.05770607
,0.03723754,0.04809197,0.06682469,0.05778326,0.05081834,0.06702459
,0.05735485,0.07558402,0.05838543,0.05136283,0.0575854,0.05220309
,0.03547077,0.05637914,0.0526619,0.05375548,0.03939058,0.0514644
,0.04774071,0.05443444,0.05088193,0.04473443]

y2=[1.40099242,0.91500619,0.62470948,0.42444233,0.31385022,0.21960475
,0.1585088,0.13625638,0.09434608,0.07814066,0.06817675,0.08205397
,0.04867518,0.04954366,0.0453354,0.04336565,0.04634658,0.0348384
,0.03406034,0.04095956,0.03111591,0.02687504,0.0391906,0.03285407
,0.03158597,0.0263301,0.02959012,0.02979444,0.02976084,0.01869583
,0.03609669,0.03266109,0.02001631,0.0280006,0.02103386,0.03407493
,0.02630104,0.02085832,0.0268858,0.01844752,0.02276421,0.02856078
,0.01970091,0.02111431,0.01872927,0.02115039,0.02512826,0.02048509
,0.02398728,0.03124381,0.022427,0.0229832,0.02142006,0.02191827
,0.01669028,0.01667212,0.02470142,0.02086455,0.02356891,0.01941286
,0.02375857,0.01669987,0.02126735,0.01940184,0.01902149,0.01440385
,0.01818145,0.01502802,0.01993214,0.01602217,0.0181882,0.03058992
,0.01629652,0.02003466,0.01470704,0.02432539,0.00951887,0.01468867
,0.01668678,0.01756034,0.01080807,0.01384837,0.02859828,0.01545237
,0.01644548,0.01399877,0.01416574,0.01251397,0.01517262,0.01613675
,0.01661097,0.01204893,0.01646716,0.01475663,0.01920516,0.01304211
,0.02250331,0.01454045,0.02163495,0.01716393,0.01592542,0.01880261
,0.02477941,0.01200265,0.01314825,0.01580665,0.00984601,0.0110579
,0.01964131,0.01445118,0.01925036,0.01507836,0.01154023,0.01568873
,0.0158195,0.01446578,0.02133539,0.01561228,0.01078266,0.01386144
,0.01476472,0.01530414,0.01584493,0.01007548,0.00905828,0.01490507
,0.01386681,0.01244102,0.01600868,0.01266312,0.01692933,0.01847751
,0.01407558,0.01533497,0.01071709,0.01741963,0.01585666,0.01417597
,0.01426585,0.01491579,0.01128806,0.0162108,0.01591602,0.01455766
,0.01495867,0.00913481,0.01562046,0.01408359,0.01011887,0.01351709
,0.00982863,0.01739003,0.01288151,0.01086836,0.014895,0.01264546
,0.0160148,0.00871813,0.0135934,0.0177342,0.01493531,0.01703642
,0.0126632,0.01523518,0.01943673,0.01148809,0.01111067,0.01681503
,0.01859791,0.01192727,0.0099016,0.01807326,0.01568811,0.01748021
,0.00953927,0.01031004,0.01234743,0.0172668,0.01752886,0.01019796
,0.01296759,0.00927358,0.01889376,0.0177454,0.01077398,0.00979594
,0.01253584,0.01288246,0.01576761,0.00943206,0.01467385,0.01204846
,0.00947777,0.01076063,0.01599157,0.01251708,0.01066409,0.00863716
,0.02241421,0.0075729,]

y3=[1.62481063,1.34350638,1.12576887,0.92885441,0.72726599,0.57668066
,0.50535151,0.41268758,0.33591224,0.29674062,0.24700556,0.22191571
,0.17618106,0.18512008,0.1861221,0.14486015,0.1534987,0.12469768
,0.12012685,0.10529895,0.09783132,0.11504636,0.10980547,0.10669884
,0.09792217,0.07740644,0.09997413,0.08852425,0.09212725,0.08903451
,0.09500255,0.07341135,0.08761601,0.07285025,0.06674259,0.08420981
,0.07996649,0.09679672,0.08156976,0.07042963,0.07373674,0.0655549
,0.06724344,0.06052651,0.06359084,0.07267718,0.05391531,0.06150604
,0.0504201,0.05068431,0.04428281,0.05573706,0.05475266,0.05298421
,0.05818008,0.06104151,0.07715561,0.0507802,0.05393714,0.05016527
,0.04313885,0.04641556,0.05709366,0.0442887,0.0567265,0.03785644
,0.04262362,0.05983752,0.04375678,0.05086901,0.04456775,0.06851016
,0.0547923,0.05558864,0.04809802,0.05445485,0.04159427,0.05616052
,0.0516655,0.04423757,0.0404153,0.04946563,0.05235377,0.05155685
,0.05310875,0.03891368,0.03753785,0.04551399,0.04724594,0.0429589
,0.04304643,0.04305141,0.04529307,0.04805063,0.03789711,0.04222709
,0.04156884,0.04834948,0.04020881,0.05945503,0.0486497,0.03769429
,0.03464222,0.04267978,0.05096399,0.03255057,0.0487812,0.03770517
,0.04152335,0.04480741,0.03384894,0.05431211,0.04223977,0.03153524
,0.03435906,0.03467678,0.04540518,0.04918642,0.03708885,0.03174695
,0.04485878,0.03513006,0.03814514,0.04183757,0.03358195,0.03361752
,0.04181262,0.03698884,0.03497308,0.0361791,0.03306384,0.04442315
,0.03138195,0.0362453,0.02519975,0.02689821,0.04195368,0.03565741
,0.03378499,0.03771234,0.03651546,0.04092797,0.03834943,0.03579235
,0.04439443,0.03707141,0.03578589,0.03723863,0.03097455,0.03015577
,0.02974678,0.03791055,0.03576183,0.02761302,0.03349718,0.0362099
,0.02893283,0.03093478,0.03238211,0.03577362,0.01988152,0.03388712
,0.03781899,0.02625326,0.03015636,0.03265373,0.03315106,0.03115737
,0.02920823,0.03725089,0.04499981,0.03401396,0.02835396,0.03479999
,0.02572304,0.03365788,0.03105183,0.02890273,0.02859719,0.03596134
,0.02815003,0.03149182,0.03246944,0.04679267,0.02576984,0.02943072
,0.02622728,0.02357962,0.02517069,0.03467919,0.03016565,0.03080059
,0.03206243,0.02881757,0.02457789,0.03042842,0.03111133,0.02050603
,0.03687479,0.03105781]

y4=[1.79583549,1.60732153,1.41187376,1.26973231,1.09631797,0.93884571
,0.84089346,0.7472226,0.61375378,0.54875762,0.50996579,0.46616057
,0.40085806,0.36056517,0.37057804,0.3177458,0.30532602,0.29796546
,0.23432439,0.24585172,0.22424167,0.21631583,0.21259815,0.18628475
,0.19219665,0.20804289,0.17474956,0.15384954,0.17753123,0.18952735
,0.1684928,0.14794235,0.15923664,0.15559661,0.15809705,0.15312957
,0.16155947,0.14625989,0.13082517,0.14217686,0.13141086,0.13405238
,0.12677757,0.12984335,0.13271753,0.13368845,0.11490196,0.1175807
,0.0983421,0.10883001,0.11041512,0.15202168,0.12655447,0.11495577
,0.08115162,0.1115533,0.10423951,0.0925094,0.09383961,0.09736712
,0.09578307,0.10108329,0.11612615,0.108569,0.10262978,0.10313185
,0.09236151,0.08444386,0.09630842,0.10222328,0.1044291,0.11072382
,0.09008579,0.11750383,0.09842574,0.08612348,0.07654412,0.0831606
,0.07319147,0.09216851,0.09138491,0.07974635,0.07971025,0.10228871
,0.09513858,0.09214096,0.08829464,0.08592549,0.08571222,0.09845265
,0.06660684,0.09522924,0.08637365,0.0888606,0.07434649,0.0942794
,0.09930679,0.09471906,0.0794556,0.07976115,0.08495343,0.08724833
,0.08729643,0.10460251,0.08590405,0.09208296,0.07852866,0.07134966
,0.0817472,0.07289456,0.06914956,0.10138446,0.06668022,0.06154154
,0.07901832,0.05585737,0.09504858,0.07281224,0.05226212,0.06455266
,0.07128864,0.08534768,0.0713462,0.07106127,0.06612314,0.10169705
,0.08094715,0.08081669,0.08360369,0.08828762,0.05481544,0.0835608
,0.09347075,0.05290385,0.07095531,0.0850571,0.08538176,0.07851271
,0.08584378,0.07457006,0.06695035,0.05527613,0.07371751,0.05653522
,0.0757097,0.05260066,0.06860074,0.06279467,0.0684932,0.08321107
,0.06175884,0.05594104,0.06453982,0.07728591,0.05940644,0.05691603
,0.07267159,0.05191686,0.06317205,0.07017592,0.06248203,0.06051507
,0.0657198,0.05251035,0.06790411,0.07508665,0.05230155,0.0506731
,0.08666097,0.05090677,0.06985988,0.06588166,0.06625275,0.05604062
,0.06018097,0.07290569,0.04806636,0.06462974,0.06348299,0.04349605
,0.08091447,0.04599867,0.07383654,0.06701827,0.06464521,0.07122774
,0.06501097,0.04817362,0.0558072,0.05601987,0.06621353,0.07125839
,0.07619249,0.0640666,0.06996091,0.07081875,0.07720077,0.07500438
,0.07224407,0.05573477]


if __name__ == '__main__':

    # plt.rcParams['font.sans-serif'] = [u'SimSun']
    # plt.rcParams['axes.unicode_minus'] = False
    # plt.rcParams['font.size'] = 14
    row_x = []
    for i in range(len(y1)):
        row_x.append(i)
    plt.plot(row_x, y1, label='Global HGNN', ls='-')

    row_x = []
    for i in range(len(y2)):
        row_x.append(i)
    plt.plot(row_x, y2, label='Local HGNN', ls='-.')

    row_x = []
    for i in range(len(y3)):
        row_x.append(i)
    plt.plot(row_x, y3, label='FedHGN w/o HC', ls=':')

    row_x = []
    for i in range(len(y4)):
        row_x.append(i)
    plt.plot(row_x, y4, label='FedHGN with HC', ls='--')

    plt.ylim(0, 2)
    plt.xlim(0, 100)
    plt.legend(loc='lower right')
    plt.ylabel('Train Loss')
    plt.xlabel('Communication Rounds')
    # plt.ylabel('故障分类准确率(%)')
    # plt.xlabel('训练迭代周期')
    plt.tick_params(axis='x', which='both', bottom=False)
    plt.rcParams['savefig.dpi'] = 300 # 图片像素
    plt.show()
